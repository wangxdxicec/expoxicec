<!doctype html>
<html>
<head>
    <style>
        .infoBox{
            background:#f5f5f5;
            width:100%;
            padding:00px 0;
            box-sizing:border-box;

        }
        #tab_header_ul{
            overflow:hidden;
            float:left;
            width:100%;
        }
        #tab_header_ul>li{
            float:left;
        }
       #addBoothHref>a{
           color:red;
           font-weight: bold;
       }
    </style>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>中国·厦门会展金泓信展览</title>

    <link rel="stylesheet" type="text/css" href="${base}/resource/expoxicec/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="${base}/resource/expoxicec/css/_all_skin.min.css">
    <link rel="stylesheet" type="text/css" href="${base}/resource/expoxicec/css/AdminLTE.min.css">
    <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="${base}/resource/expoxicec/css/Site.css">
    <link rel="stylesheet" type="text/css" href="${base}/resource/expoxicec/css/StepWizard.css">
    <link rel="stylesheet" type="text/css" href="${base}/resource/expoxicec/css/jquery.webui-popover.min.css">
    <link rel="stylesheet" type="text/css" href="${base}/resource/expoxicec/css/jquery.pagewalkthrough.min.css">
    <link rel="stylesheet" type="text/css" href="${base}/resource/expoxicec/css/bootstrap-tokenfield.min.css">

    <script type="text/javascript" src="${base}/resource/expoxicec/date.format.js"></script>
    <script type="text/javascript" src="${base}/resource/js/jquery-1.12.4.js"></script>
    <script src="${base}/resource/expoxicec/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="${base}/resource/expoxicec/js/jquery.filer.min.js" type="text/javascript"></script>
    <script src="${base}/resource/expoxicec/js/prettify.js" type="text/javascript"></script>
    <script src="${base}/resource/expoxicec/js/scripts.js" type="text/javascript"></script>

    <!--<script src="${base}/resource/expoxicec/js/browserIe.js" type="text/javascript"></script>-->
    <!--<script src="${base}/resource/expoxicec/js/hm.js" type="text/javascript"></script>-->
    <script src="${base}/resource/expoxicec/js/adminlte.js" type="text/javascript"></script>
    <script src="${base}/resource/expoxicec/js/jquery-form.js" type="text/javascript"></script>
    <script src="${base}/resource/expoxicec/js/html5ImgCompress.min.js" type="text/javascript"></script>
    <script src="${base}/resource/expoxicec/js/bootstrap-tokenfiled.js" type="text/javascript"></script>
    <!--<script src="${base}/resource/expoxicec/js/jquery-form1.js" type="text/javascript"></script>-->
    <script src="${base}/resource/expoxicec/js/jquery-pagewalkthrough.js" type="text/javascript"></script>
    <script src="${base}/resource/expoxicec/js/jquery-webui-popover.js" type="text/javascript"></script>
    <script type="text/javascript" src="${base}/resource/expoxicec/js/ajaxfileupload.js"></script>
    <script type="text/javascript" src="${base}/resource/js/common.js"></script>
</head>
<#include "/user/expoxicec/head.html" />

<body class="skin-black layout-top-nav">
<div class="skin-black layout-top-nav">
<!-- 展会公告 -->
<div class="modal fade" id="modalNotice">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                <h4 class="modal-title">展会公告</h4>
            </div>
            <div class="modal-body"></div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="btnConfirmNotice">不再显示</button>
            </div>
        </div>
    </div>
</div>
<input type="hidden" id="usermobile" value="14759166808"/>
<input type="hidden" id="projectId" value="ffa63cc9-74b7-e611-9692-000c2985450b"/>

<div class="container">
    <#include "/common/message.ftl" />
    <div id="myBooths" style="width:100%!important;">
        <div class="nav-tabs-custom" style="width:100%!important;">
            <ul id="tab_header_ul" class="nav nav-tabs"></ul>
            <div class="tab-content">
                <div class="tab-pane active" id="tab_booth_info" data-boothid="">
                    <div class="clearfix">
                        <div class="pull-left" style="width:100%;overflow:hidden;">
                            <p class="h4 margin-bottom" style="word-wrap: break-word;text-wrap:normal; width:100%">
                                <label id="booth_number_value" name="booth_number_value"></label>
                                <small>
                                    <span class="boothstatus label label-default" name="booth_current_status" id="booth_current_status"></span>
                                    <input type="hidden" class="lastAuditTime" name="booth_modify_time" id="booth_modify_time"/>
                                </small>
                            </p>
                            <p class="h5"><strong>展位名称 </strong><label id="booth_name_value" name="booth_name_value"></label></p>
                            <p class="h5"><strong>展位类型 </strong><label id="booth_type_value" name="booth_type_value"></label></p>
                            <p class="h5"><strong>联系人 </strong><label id="contact_value" name="contact_value"></label>
                            </p>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-8">
                            <div class="stepwizard">
                                <ul class="stepwizard-row" id="current_step_image">

                                </ul>
                            </div>
                            <div class="box-group" id="accordion">
                                <div class="panel box box-primary panel-documenttype1">
                                    <div class="box-header with-border">
                                        <h4 class="box-title">
                                            <a data-toggle="collapse" data-parent="#accordion" href="#collapse1" class="collapsed pull-left">
                                                申报展位对应的《展览会责任险》保单
                                            </a>
                                        </h4>
                                        <div class="pull-right">
                                            <span class="badge bg-gray badge-documentcount1" title="申报展位对应的《展览会责任险》保单"></span>
                                        </div>
                                    </div>
                                    <div id="collapse1" class="panel-collapse collapse in" aria-expanded="false">
                                        <div class="box-body clearfix">
                                            <p class="margin-bottom h5">
                                                备注：展览会责任险包括：1、展览场所建筑物自身、各种固定设备及地面、地基的损失等；2、雇请工作人员因意外人身伤害所引起的抚恤金、医疗费和其它有关费用；3、第三者的人身意外伤害所引起的抚恤金、医疗费和其它有关费用。</p>
                                            <div class="row" id="group_1">
                                                <!-- 上传组件 -->
                                                <div class="col-lg-3 col-md-4 col-sm-6 col-xs-6">
                                                    <form action="${base}/user/uploadImage" class="form-upload" name="uploadImageForm1" id="uploadImageForm1" enctype="multipart/form-data" method="post">
                                                        <input type="hidden" name="type" value="申报展位对应的《展览会责任险》保单"/>
                                                        <input type="hidden" name="BoothId" id="boothIdValue1"/>
                                                        <input type="hidden" name="tempId" value="1"/>
                                                        <div class="document-item btn-adddocument" title="上传申报展位对应的《展览会责任险》保单">
                                                            <i class="fa fa-plus fa-2x"></i>
                                                            <div class="filerequire">请上传小于 5M 的 .jpg,.png 文件</div>
                                                            <input type="file" class="hidden-fileinput" id="fileUpload" name="fileUpload"/>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="panel box box-primary panel-documenttype2">
                                    <div class="box-header with-border">
                                        <h4 class="box-title">
                                            <a data-toggle="collapse" data-parent="#accordion" href="#collapse2" class="collapsed pull-left">
                                                布展委托函
                                                <small><span class="label label-default">必选</span></small>
                                            </a>
                                        </h4>
                                        <div class="pull-right">
                                            <span class="badge bg-gray badge-documentcount2" title="布展委托函"></span>
                                        </div>
                                    </div>
                                    <div id="collapse2" class="panel-collapse collapse" style="height: 0px;">
                                        <div class="box-body clearfix">
                                            <p class="margin-bottom h5">备注：参展单位出具的布展委托函，须加盖参展单位公章</p>
                                            <div class="row" id="group_2">
                                                <!-- 上传组件 -->
                                                <div class="col-lg-3 col-md-4 col-sm-6 col-xs-6">
                                                    <form action="${base}/user/uploadImage" class="form-upload" name="uploadImageForm2" id="uploadImageForm2" enctype="multipart/form-data" method="post">
                                                        <input type="hidden" name="Type" value="布展委托函"/>
                                                        <input type="hidden" name="BoothId" id="boothIdValue2"/>
                                                        <input type="hidden" name="TempId" value="2"/>
                                                        <div class="document-item btn-adddocument" title="上传布展委托函">
                                                            <i class="fa fa-plus fa-2x"></i>
                                                            <div class="filerequire">请上传小于 5M 的 .jpg,.png 文件</div>
                                                            <input type="file" class="hidden-fileinput" id="fileUpload" name="fileUpload"/>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="panel box box-primary panel-documenttype3">
                                    <div class="box-header with-border">
                                        <h4 class="box-title">
                                            <a data-toggle="collapse" data-parent="#accordion" href="#collapse3" class="collapsed pull-left">
                                                授权委托书
                                                <small><span class="label label-default">必选</span></small>
                                            </a>
                                        </h4>
                                        <div class="pull-right">
                                            <span class="badge bg-gray badge-documentcount3" title="授权委托书"></span>
                                            <a href="http://www.stonefair.org.cn/down/tempfolder/2016/2017厦门石材展授权委托书(施工单位签署）.doc" title="下载授权委托书模版" style="margin-left:1em;" target="_blank"><i class="fa fa-download"></i>下载模版</a></div>
                                    </div>
                                    <div id="collapse3" class="panel-collapse collapse" style="height: 0px;">
                                        <div class="box-body clearfix">
                                            <p class="margin-bottom h5">备注：搭建公司授权代理人办理此报图流程的必须提供此委托书（须盖公章）</p>
                                            <div class="row" id="group_3">
                                                <!-- 上传组件 -->
                                                <div class="col-lg-3 col-md-4 col-sm-6 col-xs-6">
                                                    <form action="${base}/user/uploadImage" class="form-upload" name="uploadImageForm3" id="uploadImageForm3" enctype="multipart/form-data" method="post">
                                                        <input type="hidden" name="Type" value="授权委托书"/>
                                                        <input type="hidden" name="BoothId" id="boothIdValue3"/>
                                                        <input type="hidden" name="TempId" value="3"/>
                                                        <div class="document-item btn-adddocument" title="上传授权委托书">
                                                            <i class="fa fa-plus fa-2x"></i>
                                                            <div class="filerequire">请上传小于 5M 的 .jpg,.png 文件</div>
                                                            <input type="file" class="hidden-fileinput" id="fileUpload" name="fileUpload"/>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="panel box box-primary panel-documenttype4">
                                    <div class="box-header with-border">
                                        <h4 class="box-title">
                                            <a data-toggle="collapse" data-parent="#accordion" href="#collapse4" class="collapsed pull-left">
                                                搭建单位相关资料
                                                <small><span class="label label-default">必选</span></small>
                                            </a>
                                        </h4>
                                        <div class="pull-right">
                                            <span class="badge bg-gray badge-documentcount4" title="搭建单位相关资料"></span>
                                        </div>
                                    </div>
                                    <div id="collapse4" class="panel-collapse collapse" style="height: 0px;">
                                        <div class="box-body clearfix">
                                            <p class="margin-bottom h5">备注：营业执照副本复印件、资质证书复印件（须盖公章）</p>
                                            <div class="row" id="group_4">
                                                <!-- 上传组件 -->
                                                <div class="col-lg-3 col-md-4 col-sm-6 col-xs-6">
                                                    <form action="${base}/user/uploadImage" class="form-upload" name="uploadImageForm4" id="uploadImageForm4" enctype="multipart/form-data" method="post">
                                                        <input type="hidden" name="Type" value="搭建单位相关资料"/>
                                                        <input type="hidden" name="BoothId" id="boothIdValue4"/>
                                                        <input type="hidden" name="TempId" value="4"/>
                                                        <div class="document-item btn-adddocument" title="上传搭建单位相关资料">
                                                            <i class="fa fa-plus fa-2x"></i>
                                                            <div class="filerequire">请上传小于 5M 的 .jpg,.png 文件</div>
                                                            <input type="file" class="hidden-fileinput" id="fileUpload" name="fileUpload"/>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="panel box box-primary panel-documenttype5">
                                    <div class="box-header with-border">
                                        <h4 class="box-title">
                                            <a data-toggle="collapse" data-parent="#accordion" href="#collapse5" class="collapsed pull-left">
                                                特装展位相关图纸
                                                <small><span class="label label-default">必选</span></small>
                                            </a>
                                        </h4>
                                        <div class="pull-right">
                                            <span class="badge bg-gray badge-documentcount5" title="特装展位相关图纸"></span>
                                            <a href="http://www.stonefair.org.cn/down/TempFolder/2016/示意图.png" title="下载特装展位相关图纸模版" style="margin-left:1em;" target="_blank"><i class="fa fa-download"></i> 下载模版</a></div>
                                    </div>
                                    <div id="collapse5" class="panel-collapse collapse" style="height: 0px;">
                                        <div class="box-body clearfix">
                                            <p class="margin-bottom h5">
                                                备注：请分别单张上传：展位立体彩色效果图、立面网格图、平面图、施工图、电路图、施工材质说明图、结构图（需标注施工材质型号及连接方式）。要求清晰完整（上传时可点击左下角“使用原图上传”提高清晰度），电路图需标注回路、负载、所用材质的规格及型号等（设计师签名并盖章）</p>
                                            <div class="row" id="group_5">
                                                <!-- 上传组件 -->
                                                <div class="col-lg-3 col-md-4 col-sm-6 col-xs-6">
                                                    <form action="${base}/user/uploadImage" class="form-upload" name="uploadImageForm5" id="uploadImageForm5" enctype="multipart/form-data" method="post">
                                                        <input type="hidden" name="Type" value="特装展位相关图纸"/>
                                                        <input type="hidden" name="BoothId" id="boothIdValue5"/>
                                                        <input type="hidden" name="TempId" value="5"/>
                                                        <div class="document-item btn-adddocument" title="上传特装展位相关图纸">
                                                            <i class="fa fa-plus fa-2x"></i>
                                                            <div class="filerequire">请上传小于 5M 的 .jpg,.png 文件</div>
                                                            <input type="file" class="hidden-fileinput" id="fileUpload" name="fileUpload"/>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="panel box box-primary panel-documenttype6">
                                    <div class="box-header with-border">
                                        <h4 class="box-title">
                                            <a data-toggle="collapse" data-parent="#accordion" href="#collapse6" class="collapsed pull-left">
                                                搭建材料检验报告
                                                <small><span class="label label-default">必选</span></small>
                                            </a>
                                        </h4>
                                        <div class="pull-right">
                                            <span class="badge bg-gray badge-documentcount6" title="搭建材料检验报告"></span>
                                        </div>
                                    </div>
                                    <div id="collapse6" class="panel-collapse collapse" style="height: 0px;">
                                        <div class="box-body clearfix">
                                            <p class="margin-bottom h5">备注：搭建装饰材料防火等级证书、电气设备（3C认证）标准合格证</p>
                                            <div class="row" id="group_6">
                                                <!-- 上传组件 -->
                                                <div class="col-lg-3 col-md-4 col-sm-6 col-xs-6">
                                                    <form action="${base}/user/uploadImage" class="form-upload" name="uploadImageForm6" id="uploadImageForm6" enctype="multipart/form-data" method="post">
                                                        <input type="hidden" name="Type" value="搭建材料检验报告"/>
                                                        <input type="hidden" name="BoothId" id="boothIdValue6"/>
                                                        <input type="hidden" name="TempId" value="6"/>
                                                        <div class="document-item btn-adddocument" title="上传搭建材料检验报告">
                                                            <i class="fa fa-plus fa-2x"></i>
                                                            <div class="filerequire">请上传小于 5M 的 .jpg,.png 文件</div>
                                                            <input type="file" class="hidden-fileinput" id="fileUpload" name="fileUpload"/>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="panel box box-primary panel-documenttype7">
                                    <div class="box-header with-border">
                                        <h4 class="box-title">
                                            <a data-toggle="collapse" data-parent="#accordion" href="#collapse7" class="collapsed pull-left">
                                                现场工人相关技术资格证复印件
                                                <small><span class="label label-default">必选</span></small>
                                            </a>
                                        </h4>
                                        <div class="pull-right">
                                            <span class="badge bg-gray badge-documentcount7" title="现场工人相关技术资格证复印件"></span>
                                        </div>
                                    </div>
                                    <div id="collapse7" class="panel-collapse collapse" style="height: 0px;">
                                        <div class="box-body clearfix">
                                            <p class="margin-bottom h5">备注：如电工证、登高作业证等</p>
                                            <div class="row" id="group_7">
                                                <!-- 上传组件 -->
                                                <div class="col-lg-3 col-md-4 col-sm-6 col-xs-6">
                                                    <form action="${base}/user/uploadImage" class="form-upload" name="uploadImageForm7" id="uploadImageForm7" enctype="multipart/form-data" method="post">
                                                        <input type="hidden" name="Type" value="现场工人相关技术资格证复印件"/>
                                                        <input type="hidden" name="BoothId" id="boothIdValue7"/>
                                                        <input type="hidden" name="TempId" value="7"/>
                                                        <div class="document-item btn-adddocument" title="上传现场工人相关技术资格证复印件">
                                                            <i class="fa fa-plus fa-2x"></i>
                                                            <div class="filerequire">请上传小于 5M 的 .jpg,.png 文件</div>
                                                            <input type="file" class="hidden-fileinput" id="fileUpload" name="fileUpload"/>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 timelinepanel">
                            <button class="btn btn-primary btn-block btn-lg" name="booth_current_status_btn" id="booth_current_status_btn" data-toggle="modal" data-target="#confirm_dialog">
                                <i class="fa fa-upload"></i>&nbsp;提交审核
                            </button>
                            <div class="modal fade" tabindex="-1" id="confirm_dialog">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">提交审核</div>
                                        <div class="modal-body" style="word-break:break-word" id="submitBtnValue" name="submitBtnValue">
                                        </div>
                                        <div class="modal-footer">
                                            <form action="${base}/user/submitAllBoothInfo" method="post">
                                                <input type="hidden" name="BoothId" id="boothIdValue8"/>
                                                <input type="hidden" name="returnUrl" value="http://boothaudit.xicec.com/Project/Details/ffa63cc9-74b7-e611-9692-000c2985450b"/>
                                                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                                                <button type="submit" class="btn btn-primary">提交审核</button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <hr/>
                            <ul class="timeline" style="margin-right:-15px;" id="booth_review_result" name="booth_review_result">
                            </ul>

                            <p class="text-center">
                                <button class="btn btn-default btn-showremovebooth" title="删除此展位" data-toggle="modal" data-target="#modalDeleteBooth_dialog"><i class="fa fa-trash-o"></i> 删除此展位 </button>
                            </p>
                        </div>
                    </div>
                </div>
                <!-- 删除展位 -->
                <div class="modal modal-danger fade" id="modalDeleteBooth_dialog">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                                <h4 class="modal-title">删除展位</h4>
                            </div>
                            <div class="modal-body">
                                <p>确定要删除展位 <strong style="word-wrap: break-word" id="delBtnValue" name="delBtnValue"></strong> ？</p>
                            </div>
                            <div class="modal-footer">
                                <form action="${base}/user/deleteAllBoothInfo" method="post" >
                                    <input type="hidden" name="BoothId" id="boothIdValue9"/>
                                    <button type="button" class="btn btn-outline pull-left" data-dismiss="modal">取消</button>
                                    <button type="submit" class="btn btn-outline" name="confirmDeleteAllBoothInfo" id="confirmDeleteAllBoothInfo">确定删除</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--<div class="checkbox"><label><input type="checkbox" id="doNotCompress" />使用原图上传</label></div>-->
</div>
<#include "/user/expoxicec/bottom.html" />

<!-- 预览 -->
<div class="modal fade" id="modalPreview">
    <div class="modal-dialog modal-dialog-preview">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                <h4 class="modal-title">详情</h4>
            </div>
            <div class="modal-body"><img id="imgPreview" src="" style="width:100%"/></div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default pull-left" data-dismiss="modal">关闭</button>
            </div>
        </div>
    </div>
</div>

<!-- 图片模板 -->
<script type="text/template" id="template_loading">
    <div class="col-lg-3 col-md-4 col-sm-6 col-xs-6 loading-template">
        <div class="document-item">
            <div class="document-thumb"></div>
            <div class="document-control text-center">请稍后</div>
            <button class="btn btn-default btn-xs btn-delete-document deleteHide" data-imagename="" data-tempid="" data-boothid="">
                <i class="fa fa-trash fa-2x"></i>
            </button>
            <i class="fa fa-circle-o-notch fa-spin fa-2x"></i>
        </div>
    </div>
</script>
<div class="upload-success-notify" style="display:none"><i class="fa fa-check"></i>&nbsp;上传成功</div>

<!--引导说明-->
<div style="display:none" id="userGuide">
    <div id="userGuideStep1"><h3 class="margin-bottom">根据组委会要求上传您的展位应提交的文件</h3></div>
    <div id="userGuideStep2"><h3>您可以添加多个展位</h3></div>
    <div id="userGuideStep3"><h3>等待管理员审核您的资料</h3></div>
    <div id="userGuideStep4"><h3>查看组委会公告</h3></div>
</div></div>

</body>

<script>
    var expoBuildInfoList;
    var curBoothIdValue;
    var curTempIDValue = 1;
    var boothSetUpAddFlag;
    $(document).ready(function () {
        $.ajax({
            url: "${base}/user/getBoothList",
            type: "post",
            dataType: "json",
            success: function (e) {
                if(e.tExpoBuildInfoList != null){
                    expoBuildInfoList = JSON.parse(e.tExpoBuildInfoList);
                    //获取到Ul列表
                    var ul = document.getElementById("tab_header_ul");
                    for(var i=0;i<expoBuildInfoList.length;i++){
                        //创建元素Li
                        var li = document.createElement("li");
                        li.setAttribute("role", "presentation");
                        //将节点设置为激活状态
                        if(i == 0) {
                            li.className="active";
                            curBoothIdValue = expoBuildInfoList[i].booth_Number;
                            boothSetUpAddFlag = expoBuildInfoList[i].fair_enable;
                            document.getElementById("submitBtnValue").innerHTML = "将上传的 " + expoBuildInfoList[0].booth_Number + "相关资料提交审核？一旦提交，在得到审核结果之前无法再添加信息!";
                            document.getElementById("delBtnValue").innerHTML = expoBuildInfoList[0].booth_Number;
                            document.getElementById("boothIdValue1").value = expoBuildInfoList[0].booth_Number;
                            document.getElementById("boothIdValue2").value = expoBuildInfoList[0].booth_Number;
                            document.getElementById("boothIdValue3").value = expoBuildInfoList[0].booth_Number;
                            document.getElementById("boothIdValue4").value = expoBuildInfoList[0].booth_Number;
                            document.getElementById("boothIdValue5").value = expoBuildInfoList[0].booth_Number;
                            document.getElementById("boothIdValue6").value = expoBuildInfoList[0].booth_Number;
                            document.getElementById("boothIdValue7").value = expoBuildInfoList[0].booth_Number;
                            document.getElementById("boothIdValue8").value = expoBuildInfoList[0].booth_Number;
                            document.getElementById("boothIdValue9").value = expoBuildInfoList[0].booth_Number;
                            document.getElementById("booth_number_value").innerHTML = expoBuildInfoList[0].booth_Number;
                            document.getElementById("booth_current_status").innerHTML = expoBuildInfoList[0].current_Audit_Status;
                            if(1 == boothSetUpAddFlag){
                                document.getElementById("booth_current_status_btn").setAttribute("class","btn btn-primary btn-block btn-lg");
                                document.getElementById("booth_current_status_btn").innerHTML = expoBuildInfoList[0].current_Audit_Status_Button;
                            }else{
                                document.getElementById("booth_current_status_btn").setAttribute("class","disabled btn btn-block btn-lg btn-warning");
                                document.getElementById("booth_current_status_btn").innerHTML = "搭建资料报审已停止";
                            }

                            loadReviewBoothResult(expoBuildInfoList[0].current_Status, JSON.parse(expoBuildInfoList[0].current_Review_Info));

                            document.getElementById("booth_name_value").innerHTML = expoBuildInfoList[0].exhibitor_Company;
                            document.getElementById("booth_type_value").innerHTML = expoBuildInfoList[0].exhibitor_Type;
                            document.getElementById("contact_value").innerHTML = expoBuildInfoList[0].login_name + "【" + expoBuildInfoList[0].login_telphone + "】";
                        }

                        li.id = i;
                        //向li中添加内容
                        li.innerHTML = "<a href='#detail_info_dragdrop' role='tab' data-toggle='tab'>" + expoBuildInfoList[i].booth_Number + "</a>";

                        li.onclick = function(){
                            //将节点设置为激活状态
                            li.className="active";
                            var id_value = $(this).attr("id");
                            $("#detail_info_dragdrop").show();
                            curBoothIdValue = expoBuildInfoList[id_value].booth_Number;
                            document.getElementById("submitBtnValue").innerHTML = "将上传的 " + expoBuildInfoList[id_value].booth_Number + "相关资料提交审核？";
                            document.getElementById("delBtnValue").innerHTML = expoBuildInfoList[id_value].booth_Number;
                            document.getElementById("boothIdValue1").value = expoBuildInfoList[id_value].booth_Number;
                            document.getElementById("boothIdValue2").value = expoBuildInfoList[id_value].booth_Number;
                            document.getElementById("boothIdValue3").value = expoBuildInfoList[id_value].booth_Number;
                            document.getElementById("boothIdValue4").value = expoBuildInfoList[id_value].booth_Number;
                            document.getElementById("boothIdValue5").value = expoBuildInfoList[id_value].booth_Number;
                            document.getElementById("boothIdValue6").value = expoBuildInfoList[id_value].booth_Number;
                            document.getElementById("boothIdValue7").value = expoBuildInfoList[id_value].booth_Number;
                            document.getElementById("boothIdValue8").value = expoBuildInfoList[id_value].booth_Number;
                            document.getElementById("boothIdValue9").value = expoBuildInfoList[id_value].booth_Number;
                            document.getElementById("booth_number_value").innerHTML = expoBuildInfoList[id_value].booth_Number;
                            document.getElementById("booth_current_status").innerHTML = expoBuildInfoList[id_value].current_Audit_Status;
                            if(1 == boothSetUpAddFlag){
                                document.getElementById("booth_current_status_btn").setAttribute("class","btn btn-primary btn-block btn-lg");
                                document.getElementById("booth_current_status_btn").innerHTML = expoBuildInfoList[id_value].current_Audit_Status_Button;
                            }else{
                                document.getElementById("booth_current_status_btn").setAttribute("class","disabled btn btn-block btn-lg btn-warning");
                                document.getElementById("booth_current_status_btn").innerHTML = "搭建资料报审已停止";
                            }
                            loadReviewBoothResult(expoBuildInfoList[id_value].current_Status, JSON.parse(expoBuildInfoList[id_value].current_Review_Info));

                            document.getElementById("booth_name_value").innerHTML = expoBuildInfoList[id_value].exhibitor_Company;
                            document.getElementById("booth_type_value").innerHTML = expoBuildInfoList[id_value].exhibitor_Type;
                            document.getElementById("contact_value").innerHTML = expoBuildInfoList[id_value].login_name + "【" + expoBuildInfoList[id_value].login_telphone + "】";
                            loadImageByCurrentBoothIdAndTempId(curTempIDValue);
                        };
                        //向ul追加元素li
                        ul.appendChild(li);
                    }
                    var liAddbooth= document.createElement("li");
                    if(1 == boothSetUpAddFlag){
                        var addBooth = document.createElement("a");
                        addBooth.innerHTML = "+添加展位";
                        addBooth.href = "${base}/user/boothempty.html";
                        liAddbooth.setAttribute("id","addBoothHref");
                        liAddbooth.appendChild(addBooth);
                    }
                    ul.appendChild(liAddbooth);
                    curTempIDValue = 1;
                    //初始化对应的数据
                    loadImageByCurrentBoothIdAndTempId(7);
                    loadImageByCurrentBoothIdAndTempId(6);
                    loadImageByCurrentBoothIdAndTempId(5);
                    loadImageByCurrentBoothIdAndTempId(4);
                    loadImageByCurrentBoothIdAndTempId(3);
                    loadImageByCurrentBoothIdAndTempId(2);
                    loadImageByCurrentBoothIdAndTempId(1);

                    var projectstat = parseInt(boothSetUpAddFlag) == 0 ? true : false;
                    if (projectstat) {
                        $('#btnShowCreateBooth').remove();
                        $('.btn-showremovebooth').remove();
                        $('.form-upload').parent().remove();
                        $('.btn-delete-document').remove();
                    }
                }
            }
        });

        function loadReviewBoothResult(curReviewStatus, curReviewInfo){
            var stepUl = document.getElementById("current_step_image");
            stepUl.innerHTML = "";
            if(1 == curReviewStatus){
                $('.hidden-fileinput').parent().show();

                var stepli = document.createElement("li");
                stepli.setAttribute("class", "stepwizard-step active");
                stepli.innerHTML = "<a><i class='fa fa-upload'></i></a><p>上传资料<br/>预订展具</p>";
                stepUl.appendChild(stepli);
                stepli = document.createElement("li");
                stepli.setAttribute("class", "stepwizard-step");
                stepli.innerHTML = "<a><i class='fa fa-hourglass-half'></i></a><p>等待审核</p>";
                stepUl.appendChild(stepli);
                stepli = document.createElement("li");
                stepli.setAttribute("class", "stepwizard-step");
                stepli.innerHTML = "<a><i class='fa fa-check'></i></a><p>审核通过</p>";
                stepUl.appendChild(stepli);
                document.getElementById("booth_current_status").setAttribute("class","boothstatus label label-default");
                //document.getElementById("booth_current_status_btn").setAttribute("class","btn btn-primary btn-block btn-lg");
            }else if(2 == curReviewStatus){
                $('.hidden-fileinput').parent().show();

                var stepli = document.createElement("li");
                stepli.setAttribute("class", "stepwizard-step stepwizard-done");
                stepli.innerHTML = "<a><i class='fa fa-upload'></i></a><p>上传资料<br/>预订展具</p>";
                stepUl.appendChild(stepli);
                stepli = document.createElement("li");
                stepli.setAttribute("class", "stepwizard-step active");
                stepli.innerHTML = "<a><i class='fa fa-hourglass-half'></i></a><p>等待审核</p>";
                stepUl.appendChild(stepli);
                stepli = document.createElement("li");
                stepli.setAttribute("class", "stepwizard-step");
                stepli.innerHTML = "<a><i class='fa fa-check'></i></a><p>审核通过</p>";
                stepUl.appendChild(stepli);
                document.getElementById("booth_current_status").setAttribute("class","boothstatus label label-info");
                //document.getElementById("booth_current_status_btn").setAttribute("class","disabled btn btn-block btn-lg btn-default");
            }else if(3 == curReviewStatus){
                $('.hidden-fileinput').parent().hide();

                var stepli = document.createElement("li");
                stepli.setAttribute("class", "stepwizard-step stepwizard-done");
                stepli.innerHTML = "<a><i class='fa fa-upload'></i></a><p>上传资料<br/>预订展具</p>";
                stepUl.appendChild(stepli);
                stepli = document.createElement("li");
                stepli.setAttribute("class", "stepwizard-step stepwizard-done");
                stepli.innerHTML = "<a><i class='fa fa-hourglass-half'></i></a><p>等待审核</p>";
                stepUl.appendChild(stepli);
                stepli = document.createElement("li");
                stepli.setAttribute("class", "stepwizard-step active stepwizard-step-success");
                stepli.innerHTML = "<a><i class='fa fa-check'></i></a><p>审核通过</p>";
                stepUl.appendChild(stepli);
                document.getElementById("booth_current_status").setAttribute("class","boothstatus label label-success");
                //document.getElementById("booth_current_status_btn").setAttribute("class","disabled btn btn-block btn-lg btn-success");
            }else if(4 == curReviewStatus){
                $('.hidden-fileinput').parent().show();

                var stepli = document.createElement("li");
                stepli.setAttribute("class", "stepwizard-step stepwizard-done");
                stepli.innerHTML = "<a><i class='fa fa-upload'></i></a><p>上传资料<br/>预订展具</p>";
                stepUl.appendChild(stepli);
                stepli = document.createElement("li");
                stepli.setAttribute("class", "stepwizard-step stepwizard-done");
                stepli.innerHTML = "<a><i class='fa fa-hourglass-half'></i></a><p>等待审核</p>";
                stepUl.appendChild(stepli);
                stepli = document.createElement("li");
                stepli.setAttribute("class", "stepwizard-step active stepwizard-step-danger");
                stepli.innerHTML = "<a><i class='fa fa-remove'></i></a><p>审核不通过<br>详见审核信息</p>";
                stepUl.appendChild(stepli);
                document.getElementById("booth_current_status").setAttribute("class","boothstatus label label-danger");
                //document.getElementById("booth_current_status_btn").setAttribute("class","disabled btn btn-block btn-lg btn-danger");
            }
            //加载当前展位的审核信息
            loadCurrentReivewInfo(curReviewInfo);
        }

        function loadCurrentReivewInfo(curReviewInfo){
            //当前状态对应的审核结果
            var reviewReultInfoUl = document.getElementById("booth_review_result");
            reviewReultInfoUl.innerHTML = "";
            var reviewli = document.createElement("li");
            reviewli.setAttribute("class", "time-label");
            reviewli.innerHTML = "<span class='bg-tangjiuhui' style='font-size:1.2em;font-weight:normal;'>审核信息</span>";
            reviewReultInfoUl.appendChild(reviewli);

            if(curReviewInfo != null && curReviewInfo.length > 0){
                for(var index=0,reviewInfo; reviewInfo=curReviewInfo[index++];){
                    var header = reviewInfo.review_header;
                    var content = reviewInfo.review_content;
                    var time = reviewInfo.review_time;
                    if(index == 1){
                        reviewli = document.createElement("li");
                        reviewli.setAttribute("class", "");
                        reviewli.setAttribute("data-aid", reviewInfo.id);
                        if(content != null && content != ""){
                            reviewli.innerHTML = "<i class='fa fa-remove bg-red'></i><div class='timeline-item'><h3 class='timeline-header'>" + header + "</h3><div class='timeline-body'>" + content + "<div class='timeline-footer text-right'><span class='time'><i class='fa fa-clock-o'></i>" + time + "</span></div></div>";
                        }else{
                            reviewli.innerHTML = "<i class='fa fa-check bg-green'></i><div class='timeline-item'><h3 class='timeline-header'>" + header + "</h3>" + "<div class='timeline-footer text-right'><span class='time'><i class='fa fa-clock-o'></i>" + time + "</span></div></div>";
                        }
                        reviewReultInfoUl.appendChild(reviewli);
                    }else{
                        reviewli = document.createElement("li");
                        reviewli.setAttribute("class", "audithistory");
                        reviewli.setAttribute("data-aid", reviewInfo.id);
                        if(content != null && content != ""){
                            reviewli.innerHTML = "<i class='fa fa-remove bg-red'></i><div class='timeline-item'><h3 class='timeline-header'>" + header + "</h3><div class='timeline-body'>" + content + "<div class='timeline-footer text-right'><span class='time'><i class='fa fa-clock-o'></i>" + time + "</span></div></div>";
                        }else{
                            reviewli.innerHTML = "<i class='fa fa-check bg-green'></i><div class='timeline-item'><h3 class='timeline-header'>" + header + "</h3>" + "<div class='timeline-footer text-right'><span class='time'><i class='fa fa-clock-o'></i>" + time + "</span></div></div>";
                        }
                        reviewReultInfoUl.appendChild(reviewli);
                    }
                }
                if(curReviewInfo != null && curReviewInfo.length > 1){
                    reviewli = document.createElement("li");
                    reviewli.setAttribute("class", "time-label");
                    reviewli.innerHTML = "<span class='bg-gray btn-toggle-history' id = 'toggle-history-btn' name = 'toggle-history-btn' style='font-weight: normal;'>查看历史审核信息</span>";
                    reviewReultInfoUl.appendChild(reviewli);

                    var toggleHistoryBtn = document.getElementById("toggle-history-btn");
                    toggleHistoryBtn.onclick = function () {
                        $(this).hide().parents('ul').find('.audithistory').slideDown();
                    };
                }
            }else{
                reviewli = document.createElement("li");
                reviewli.innerHTML = "<i class='fa fa-info bg-gray'></i><div class='timeline-item'><h3 class='timeline-header'>暂无审核信息</h3></div>";
                reviewReultInfoUl.appendChild(reviewli);
            }

            reviewli = document.createElement("li");
            reviewli.innerHTML = "<i class='fa fa-history'></i>";
            reviewReultInfoUl.appendChild(reviewli);
        }

        // 显示通知
        if (parseInt('0') == 1) {
            $('#modalNotice').modal('show');
        }
        // 不再显示通知
        $('#btnConfirmNotice').click(function () {
            /*$('#modalNotice').modal('hide');
            $.ajax({
                url: '/Project/ConfirmNotice',
                type: 'POST',
                data: { ProjectId: 'ffa63cc9-74b7-e611-9692-000c2985450b' }
            });*/
        });

        $('.boothstatus').webuiPopover({
            title: '审核流程',
            trigger: 'hover',
            placement: 'right',
            animation: 'pop',
            content: '<div class="text-center">上传资料 / 预订展具<br /><i class="fa fa-long-arrow-down"></i><br />等待审核<br /><i class="fa fa-long-arrow-down"></i><br />通过审核<br /><i class="fa fa-long-arrow-down"></i><br />现场布展'
        });

        // 删除文件
        function deleteImage(e) {
            if (confirm("确定删除此文件？")) {
                var imageName = e.data('imagename');
                var tempid = e.data('tempid');
                var boothid = e.data('boothid');
                console.log('确定删除' + imageName);
                $.ajax({
                    url: '${base}/user/deleteImgByImageType',
                    data: { tempid: tempid, imagename:imageName, boothid:boothid },
                    type: 'post',
                    success: function (data) {
                        if (data.resultCode == 0) {
                            updateBoothStatus($(e));
                            e.parents('.document-item').parent().fadeOut(200, function () {
                                $(this).remove();
                                updateDocumentCount(tempid);
                            });
                        }
                        else {
                            alert(data.description);
                        }
                    }
                });
            }
        }

        // 选择文件
        $('.hidden-fileinput').on('change', function (e) {
            var input = $(this);
            var form = $(this).parents('form');
            var loadingHtml = $('#template_loading').html();
            $(this).parents('form').parent().before(loadingHtml);
            //console.log(e.target.files[0]);
            var file = e.target.files[0];
            var filename = file.name;
            var ext = filename.split('.')[filename.split('.').length - 1].toLowerCase();
            var size = file.size;
            var flag = $('#doNotCompress').prop('checked');
            if ($('#doNotCompress').prop('checked') && (ext == 'jpg' || ext == 'jpeg' || ext == 'png') && file.size > 200000) { // 对大于200k的图片进行压缩
                new html5ImgCompress(e.target.files[0], {
                    before: function (file) {
                        console.log('开始压缩 ...');
                    },
                    done: function (file, base64) {
                        console.log('压缩成功...');
                        console.log(base64.length + ' / ' + file.size);
                        var boothId = form.find('input[name="BoothId"]').val();
                        var tempId = form.find('input[name="TempId"]').val();
                        var type = form.find('input[name="Type"]').val();
                        uploadCompressedImage(boothId, tempId, type, base64);

                    },
                    fail: function (file) {
                        if (confirm('压缩失败，是否使用原图上传？'))
                            form.submit();
                    },
                    complate: function (file) {
                        console.log('压缩完成...');
                    },
                    notSupport: function (file) {
                        if (confirm('浏览器不支持压缩图片，是否使用原图上传？'))
                            form.submit();
                    }
                });
            }
            else {
                form.submit();
            }
            updateBoothStatus($(this));
            $(this).val('');
        });

        function uploadCompressedImage(boothId, tempId, type, base64) {
            var postData = { boothId: boothId, tempId: tempId, type: type, base64: base64 };
            console.log(postData);
            $.ajax({
                url: '${base}/user/uploadImage',
                type: 'POST',
                data: postData,
                success: function (result) {
                    showNewImage(result)
                }
            })
        }

        // 更新展位状态
        function updateBoothStatus(e) {
            e.parents('.tab-pane').find('.boothstatus').text('上传资料').addClass('label-default')
                .removeClass('label-success').removeClass('label-danger').removeClass('label-info');
        }

        // 预览
        $('.btnpreview').click(function () {
            var src = $(this).data('src');
            showImagePreview(src)
        });

        // 显示图片预览
        function showImagePreview(src) {
            $('#modalPreview').modal('show');
            $('#imgPreview').attr('src', src);
        }

        // 显示上传成功提示
        function showSuccessNotify() {
            $('.upload-success-notify').show().delay(800).fadeOut(200);
        }

        // 原图上传
        $('.form-upload').ajaxForm({
            complete: function (xhr) {
                var data = JSON.parse(xhr.responseText);
                showNewImage(data);
                showSuccessNotify();
            }
        });

        //更新展位状态
        function showNewImage(data) {
            var target = $('#group_' + data.tempid).find('.loading-template').eq(0);
            if (JSON.parse(data.result)) {
                var content = target.find('.document-thumb');
                if (JSON.parse(data.preview)) {
                    content.css('background-image', 'url(${base}/user/loadImgByImageType?tempid=' + data.tempid
                        + '&imagename=' + encodeURI(data.imagesrc) + '&boothid=' + data.boothid + '&mobilephone=' + '' + ')').click(function () {
                        showImagePreview('${base}/user/loadImgByImageType?tempid=' + data.tempid + '&imagename=' + encodeURI(data.imagesrc) + '&boothid=' + data.boothid + '&mobilephone=' + '');
                    });
                }
                else {
                    content.append('<a class="document-noimage-icon" href="' + data.imagesrc + '"><i class="fa fa-3x fa-file-image-o"></i></a>');
                }
                content.siblings('.document-control').text(data.createTime).removeClass('text-center');
                content.siblings('.btn-delete-document').attr("data-tempid", data.tempid);
                content.siblings('.btn-delete-document').attr("data-boothid", data.boothid);
                content.siblings('.btn-delete-document').attr("data-imagename", data.imagesrc).bind('click', function () {
                    deleteImage($(this));
                });
                target.find('.fa-circle-o-notch').remove();
                target.removeClass('loading-template');
                updateDocumentCount(data.tempid);
                showSuccessNotify();
            }
            else {
                target.remove();
                alert("上传出错");
            }
        }

        // 更新上传图片计数
        function updateDocumentCount(tempid) {
            $('.panel-documenttype' + tempid).each(function () {
                var count = $(this).find('.document-thumb').length;
                if (count > 0) {
                    $(this).find('.badge-documentcount' + tempid).text(count);
                }
                else {
                    $(this).find('.badge-documentcount' + tempid).empty();
                }
            });
        }

        $(function () {
            $('#collapse1').on('show.bs.collapse', function () {
                loadImageByCurrentBoothIdAndTempId(1);
            });
            $('#collapse2').on('show.bs.collapse', function () {
                loadImageByCurrentBoothIdAndTempId(2);
            });
            $('#collapse3').on('show.bs.collapse', function () {
                loadImageByCurrentBoothIdAndTempId(3);
            });
            $('#collapse4').on('show.bs.collapse', function () {
                loadImageByCurrentBoothIdAndTempId(4);
            });
            $('#collapse5').on('show.bs.collapse', function () {
                loadImageByCurrentBoothIdAndTempId(5);
            });
            $('#collapse6').on('show.bs.collapse', function () {
                loadImageByCurrentBoothIdAndTempId(6);
            });
            $('#collapse7').on('show.bs.collapse', function () {
                loadImageByCurrentBoothIdAndTempId(7);
            });
        });

        //根据当前展位和图片类别显示对应图片
        function loadImageByCurrentBoothIdAndTempId(tempid) {
            curTempIDValue = tempid;
            var formIndex = 7 - tempid;
            $('.btn-delete-document').parents('.document-item').parent().remove();

            $.ajax({
                url: '${base}/user/loadImageByCurrentBoothIdAndTempId',
                data: { boothid: curBoothIdValue, tempid:tempid, mobilephone:'' },
                type: 'post',
                success: function (data) {
                    if(data.resultCode == 0){
                        var boothImageList = JSON.parse(data.boothImageInfoArrayListReslut);
                        if (boothImageList != null && boothImageList.length > 0) {
                            for (var i = 0, imageInfo; imageInfo = boothImageList[i++];) {
                                var loadingHtml = $('#template_loading').html();
                                $('.hidden-fileinput').parents('form').eq(formIndex).parent().before(loadingHtml);
                                var target = $('#group_' + imageInfo.tempid).find('.loading-template').eq(0);
                                var content = target.find('.document-thumb');
                                if (imageInfo.preview) {
                                    content.css('background-image', 'url(${base}/user/loadImgByImageType?tempid=' + imageInfo.tempid
                                        + '&imagename=' + encodeURI(imageInfo.fileName) + '&boothid=' + imageInfo.curBoothid + '&mobilephone=' + '' + ')').click(function () {
                                        var imageSrc = $(this).css('backgroundImage');
                                        var reg = /\"(.*?)\"/g;
                                        var imageSrcValue = reg.exec(imageSrc);
                                        showImagePreview(imageSrcValue[1]);
                                    });
                                }
                                else {
                                    content.append('<a class="document-noimage-icon" href="' + data.description + '"><i class="fa fa-3x fa-file-image-o"></i></a>');
                                }
                                content.siblings('.document-control').text(imageInfo.modifyDate).removeClass('text-center');
                                content.siblings('.btn-delete-document').attr("data-tempid", tempid);
                                content.siblings('.btn-delete-document').attr("data-boothid", curBoothIdValue);
                                content.siblings('.btn-delete-document').attr("data-imagename", imageInfo.fileName).bind('click', function () {
                                    deleteImage($(this));
                                });
                                //3：表示审核通过，则不让其删掉对应的文件
                                if (3 != imageInfo.curReviewStatus) {
                                    $('.deleteHide>.fa-trash').show();
                                } else {
                                    //$('.deleteHide>.fa-trash').hide();
                                    target.find('.btn-delete-document').remove();
                                }
                                target.find('.fa-circle-o-notch').remove();
                                updateDocumentCount(imageInfo.tempid);
                                target.removeClass('loading-template');
                            }
                        }
                    }
                }
            });
        }

        function refreshCurrentPageInfo(boothValue) {
            alert("boothValue: " + boothValue);
            $.ajax({
                url: '${base}/user/getCurrentExpoXicecInfoByBoothId',
                data: { boothid: boothValue },
                type: 'post',
                success: function (data) {
                    alert(data);
                    window.location.href = "${base}/user/boothlist.html";
                }
            });
        }
    });
</script>
</html>